<html>
<head>
<title>Uebung_7.sc</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #fbf1c7;}
.s1 { color: #928374; font-style: italic;}
.s2 { color: #fe8019;}
.s3 { color: #b8bb26;}
.s4 { color: #f8e1aa;}
.s5 { color: #ebdbb2;}
.s6 { color: #d3869b;}
</style>
</head>
<body bgcolor="#282828">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
Uebung_7.sc</font>
</center></td></tr></table>
<pre>
<span class="s1">// Function to group a list of integers by their modulo value</span>
<span class="s2">def </span><span class="s3">moduloMap</span><span class="s4">(</span><span class="s0">l: List</span><span class="s4">[</span><span class="s0">Int</span><span class="s4">]</span><span class="s5">, </span><span class="s0">mod_value: Int</span><span class="s4">)</span><span class="s0">: Map</span><span class="s4">[</span><span class="s0">Int</span><span class="s5">, </span><span class="s0">List</span><span class="s4">[</span><span class="s0">Int</span><span class="s4">]] </span><span class="s5">= </span><span class="s4">{</span>
  <span class="s0">l</span><span class="s5">.</span><span class="s0">groupBy</span><span class="s4">(</span><span class="s0">_ % mod_value</span><span class="s4">)</span>
<span class="s4">}</span>

<span class="s2">val </span><span class="s0">l </span><span class="s5">= </span><span class="s0">List</span><span class="s4">(</span><span class="s6">1</span><span class="s5">, </span><span class="s6">4</span><span class="s5">, </span><span class="s6">5</span><span class="s5">, </span><span class="s6">7</span><span class="s5">, </span><span class="s6">8</span><span class="s5">, </span><span class="s6">9</span><span class="s4">)</span>

<span class="s1">// Call the moduloMap function with a list and a modulo value</span>
<span class="s0">moduloMap</span><span class="s4">(</span><span class="s0">l</span><span class="s5">, </span><span class="s6">3</span><span class="s4">)</span>

<span class="s1">// Function to count the number of words of each length in a list of strings</span>
<span class="s2">def </span><span class="s3">countLetters</span><span class="s4">(</span><span class="s0">l: List</span><span class="s4">[</span><span class="s0">String</span><span class="s4">])</span><span class="s0">: Map</span><span class="s4">[</span><span class="s0">Int</span><span class="s5">, </span><span class="s0">Int</span><span class="s4">] </span><span class="s5">= </span><span class="s4">{</span>
  <span class="s0">l</span><span class="s5">.</span><span class="s0">groupBy</span><span class="s4">(</span><span class="s0">_</span><span class="s5">.</span><span class="s0">length</span><span class="s4">) </span><span class="s1">// group by word length</span>
    <span class="s5">.</span><span class="s0">view</span><span class="s5">.</span><span class="s0">mapValues</span><span class="s4">(</span><span class="s0">_</span><span class="s5">.</span><span class="s0">size</span><span class="s4">)</span><span class="s5">.</span><span class="s0">toMap </span><span class="s1">// count the number of words with each length</span>
<span class="s4">}</span>

<span class="s2">val </span><span class="s0">w </span><span class="s5">= </span><span class="s0">List</span><span class="s4">(</span><span class="s3">&quot;Hallo&quot;</span><span class="s5">, </span><span class="s3">&quot;das&quot;</span><span class="s5">, </span><span class="s3">&quot;sind&quot;</span><span class="s5">, </span><span class="s3">&quot;ein&quot;</span><span class="s5">, </span><span class="s3">&quot;paar&quot;</span><span class="s5">, </span><span class="s3">&quot;WÃ¶rter&quot;</span><span class="s4">)</span>

<span class="s1">// Call the countLetters function with a list of words</span>
<span class="s0">countLetters</span><span class="s4">(</span><span class="s0">w</span><span class="s4">)</span>

<span class="s1">// Alternative implementation of countLetters using foldLeft</span>
<span class="s2">def </span><span class="s3">countLetters_v1</span><span class="s4">(</span><span class="s0">l: List</span><span class="s4">[</span><span class="s0">String</span><span class="s4">])</span><span class="s0">: Map</span><span class="s4">[</span><span class="s0">Int</span><span class="s5">, </span><span class="s0">Int</span><span class="s4">] </span><span class="s5">= </span><span class="s4">{</span>
  <span class="s0">l</span><span class="s5">.</span><span class="s0">foldLeft</span><span class="s4">(</span><span class="s0">Map</span><span class="s5">.</span><span class="s0">empty</span><span class="s4">[</span><span class="s0">Int</span><span class="s5">, </span><span class="s0">Int</span><span class="s4">]) { (</span><span class="s0">acc</span><span class="s5">, </span><span class="s0">word</span><span class="s4">) </span><span class="s5">=&gt;</span>
    <span class="s2">val </span><span class="s0">length </span><span class="s5">= </span><span class="s0">word</span><span class="s5">.</span><span class="s0">length</span>
    <span class="s0">acc + </span><span class="s4">(</span><span class="s0">length -&gt; </span><span class="s4">(</span><span class="s0">acc</span><span class="s5">.</span><span class="s0">getOrElse</span><span class="s4">(</span><span class="s0">length</span><span class="s5">, </span><span class="s6">0</span><span class="s4">) </span><span class="s0">+ </span><span class="s6">1</span><span class="s4">))</span>
  <span class="s4">}</span>
<span class="s4">}</span>

<span class="s1">// Call the alternative countLetters function with a list of words</span>
<span class="s0">countLetters_v1</span><span class="s4">(</span><span class="s0">w</span><span class="s4">)</span>

<span class="s1">// Function to calculate the average of even and odd numbers in a list</span>
<span class="s2">def </span><span class="s3">avgNumbers</span><span class="s4">(</span><span class="s0">l: List</span><span class="s4">[</span><span class="s0">Int</span><span class="s4">])</span><span class="s0">: Map</span><span class="s4">[</span><span class="s0">Boolean</span><span class="s5">, </span><span class="s0">Double</span><span class="s4">] </span><span class="s5">= </span><span class="s4">{</span>
  <span class="s2">val </span><span class="s4">(</span><span class="s0">even</span><span class="s5">, </span><span class="s0">odd</span><span class="s4">) </span><span class="s5">= </span><span class="s0">l</span><span class="s5">.</span><span class="s0">partition</span><span class="s4">(</span><span class="s0">_ % </span><span class="s6">2 </span><span class="s0">== </span><span class="s6">0</span><span class="s4">) </span><span class="s1">// partition into even and odd</span>
  <span class="s0">Map</span><span class="s4">(</span><span class="s2">false </span><span class="s0">-&gt; odd</span><span class="s5">.</span><span class="s0">sum</span><span class="s5">.</span><span class="s0">toDouble / odd</span><span class="s5">.</span><span class="s0">size</span><span class="s5">, </span><span class="s2">true </span><span class="s0">-&gt; even</span><span class="s5">.</span><span class="s0">sum</span><span class="s5">.</span><span class="s0">toDouble / even</span><span class="s5">.</span><span class="s0">size</span><span class="s4">)</span>
<span class="s4">}</span>

<span class="s2">val </span><span class="s0">l2 </span><span class="s5">= </span><span class="s0">List</span><span class="s4">(</span><span class="s6">1</span><span class="s5">, </span><span class="s6">4</span><span class="s5">, </span><span class="s6">5</span><span class="s5">, </span><span class="s6">7</span><span class="s5">, </span><span class="s6">8</span><span class="s5">, </span><span class="s6">9</span><span class="s4">)</span>

<span class="s1">// Call the avgNumbers function with a list of numbers</span>
<span class="s0">avgNumbers</span><span class="s4">(</span><span class="s0">l</span><span class="s4">)</span>

<span class="s1">// List of tuples representing work hours per week for different people</span>
<span class="s2">val </span><span class="s0">stundenProtokoll: List</span><span class="s4">[(</span><span class="s0">String</span><span class="s5">, </span><span class="s0">Int</span><span class="s5">, </span><span class="s0">List</span><span class="s4">[</span><span class="s0">Int</span><span class="s4">])] </span><span class="s5">= </span><span class="s0">List</span><span class="s4">(</span>
  <span class="s4">(</span><span class="s3">&quot;Hans&quot;</span><span class="s5">, </span><span class="s6">1</span><span class="s5">, </span><span class="s0">List</span><span class="s4">(</span><span class="s6">7</span><span class="s5">, </span><span class="s6">9</span><span class="s5">, </span><span class="s6">4</span><span class="s5">, </span><span class="s6">12</span><span class="s5">, </span><span class="s6">8</span><span class="s4">))</span><span class="s5">,</span>
  <span class="s4">(</span><span class="s3">&quot;Hans&quot;</span><span class="s5">, </span><span class="s6">2</span><span class="s5">, </span><span class="s0">List</span><span class="s4">(</span><span class="s6">8</span><span class="s5">, </span><span class="s6">2</span><span class="s5">, </span><span class="s6">10</span><span class="s5">, </span><span class="s6">12</span><span class="s5">, </span><span class="s6">12</span><span class="s4">))</span><span class="s5">,</span>
  <span class="s4">(</span><span class="s3">&quot;Hans&quot;</span><span class="s5">, </span><span class="s6">3</span><span class="s5">, </span><span class="s0">List</span><span class="s4">(</span><span class="s6">8</span><span class="s5">, </span><span class="s6">8</span><span class="s5">, </span><span class="s6">8</span><span class="s5">, </span><span class="s6">7</span><span class="s5">, </span><span class="s6">9</span><span class="s4">))</span><span class="s5">,</span>
  <span class="s4">(</span><span class="s3">&quot;Hans&quot;</span><span class="s5">, </span><span class="s6">4</span><span class="s5">, </span><span class="s0">List</span><span class="s4">(</span><span class="s6">8</span><span class="s5">, </span><span class="s6">9</span><span class="s5">, </span><span class="s6">10</span><span class="s5">, </span><span class="s6">9</span><span class="s5">, </span><span class="s6">8</span><span class="s4">))</span><span class="s5">,</span>
  <span class="s4">(</span><span class="s3">&quot;Monika&quot;</span><span class="s5">, </span><span class="s6">1</span><span class="s5">, </span><span class="s0">List</span><span class="s4">(</span><span class="s6">6</span><span class="s5">, </span><span class="s6">9</span><span class="s5">, </span><span class="s6">8</span><span class="s5">, </span><span class="s6">7</span><span class="s5">, </span><span class="s6">8</span><span class="s4">))</span><span class="s5">,</span>
  <span class="s4">(</span><span class="s3">&quot;Monika&quot;</span><span class="s5">, </span><span class="s6">2</span><span class="s5">, </span><span class="s0">List</span><span class="s4">(</span><span class="s6">7</span><span class="s5">, </span><span class="s6">9</span><span class="s5">, </span><span class="s6">8</span><span class="s5">, </span><span class="s6">6</span><span class="s5">, </span><span class="s6">9</span><span class="s4">))</span><span class="s5">,</span>
  <span class="s4">(</span><span class="s3">&quot;Monika&quot;</span><span class="s5">, </span><span class="s6">3</span><span class="s5">, </span><span class="s0">List</span><span class="s4">(</span><span class="s6">12</span><span class="s5">, </span><span class="s6">9</span><span class="s5">, </span><span class="s6">12</span><span class="s5">, </span><span class="s6">8</span><span class="s5">, </span><span class="s6">7</span><span class="s4">))</span><span class="s5">,</span>
  <span class="s4">(</span><span class="s3">&quot;Monika&quot;</span><span class="s5">, </span><span class="s6">4</span><span class="s5">, </span><span class="s0">List</span><span class="s4">(</span><span class="s6">6</span><span class="s5">, </span><span class="s6">9</span><span class="s4">))</span><span class="s5">,</span>
  <span class="s4">(</span><span class="s3">&quot;Kevin&quot;</span><span class="s5">, </span><span class="s6">1</span><span class="s5">, </span><span class="s0">List</span><span class="s4">(</span><span class="s6">6</span><span class="s5">, </span><span class="s6">9</span><span class="s5">, </span><span class="s6">8</span><span class="s5">, </span><span class="s6">7</span><span class="s5">, </span><span class="s6">8</span><span class="s4">))</span><span class="s5">,</span>
  <span class="s4">(</span><span class="s3">&quot;Kevin&quot;</span><span class="s5">, </span><span class="s6">2</span><span class="s5">, </span><span class="s0">List</span><span class="s4">(</span><span class="s6">7</span><span class="s5">, </span><span class="s6">8</span><span class="s5">, </span><span class="s6">8</span><span class="s5">, </span><span class="s6">7</span><span class="s5">, </span><span class="s6">9</span><span class="s4">))</span><span class="s5">,</span>
  <span class="s4">(</span><span class="s3">&quot;Kevin&quot;</span><span class="s5">, </span><span class="s6">3</span><span class="s5">, </span><span class="s0">List</span><span class="s4">(</span><span class="s6">12</span><span class="s5">, </span><span class="s6">3</span><span class="s5">, </span><span class="s6">12</span><span class="s5">, </span><span class="s6">3</span><span class="s5">, </span><span class="s6">2</span><span class="s4">))</span><span class="s5">,</span>
  <span class="s4">(</span><span class="s3">&quot;Kevin&quot;</span><span class="s5">, </span><span class="s6">4</span><span class="s5">, </span><span class="s0">List</span><span class="s4">(</span><span class="s6">12</span><span class="s5">, </span><span class="s6">3</span><span class="s4">))</span>
<span class="s4">)</span>

<span class="s1">// Function to find the maximum work done in a single week</span>
<span class="s2">def </span><span class="s3">maxWorkPerWeek</span><span class="s4">(</span><span class="s0">l: List</span><span class="s4">[(</span><span class="s0">String</span><span class="s5">, </span><span class="s0">Int</span><span class="s5">, </span><span class="s0">List</span><span class="s4">[</span><span class="s0">Int</span><span class="s4">])])</span><span class="s0">: </span><span class="s4">(</span><span class="s0">String</span><span class="s5">, </span><span class="s0">Int</span><span class="s5">, </span><span class="s0">Int</span><span class="s4">) </span><span class="s5">= </span><span class="s4">{</span>
  <span class="s0">l</span><span class="s5">.</span><span class="s0">flatMap </span><span class="s4">{ </span><span class="s2">case </span><span class="s4">(</span><span class="s0">name</span><span class="s5">, </span><span class="s0">week</span><span class="s5">, </span><span class="s0">hours</span><span class="s4">) </span><span class="s5">=&gt;</span>
    <span class="s0">hours</span><span class="s5">.</span><span class="s0">map</span><span class="s4">(</span><span class="s0">hour </span><span class="s5">=&gt; </span><span class="s4">(</span><span class="s0">name</span><span class="s5">, </span><span class="s0">week</span><span class="s5">, </span><span class="s0">hour</span><span class="s4">))</span>
  <span class="s4">}</span><span class="s5">.</span><span class="s0">maxBy</span><span class="s4">(</span><span class="s0">_</span><span class="s5">.</span><span class="s0">_3</span><span class="s4">)</span>
<span class="s4">}</span>

<span class="s1">// Call the maxWorkPerWeek function with the work hours list</span>
<span class="s0">maxWorkPerWeek</span><span class="s4">(</span><span class="s0">stundenProtokoll</span><span class="s4">)</span>

<span class="s1">// Function to find the person with the maximum total work hours</span>
<span class="s2">def </span><span class="s3">maxWork</span><span class="s4">(</span><span class="s0">l: List</span><span class="s4">[(</span><span class="s0">String</span><span class="s5">, </span><span class="s0">Int</span><span class="s5">, </span><span class="s0">List</span><span class="s4">[</span><span class="s0">Int</span><span class="s4">])])</span><span class="s0">: </span><span class="s4">(</span><span class="s0">String</span><span class="s5">, </span><span class="s0">Int</span><span class="s4">) </span><span class="s5">= </span><span class="s4">{</span>
  <span class="s0">l</span><span class="s5">.</span><span class="s0">map </span><span class="s4">{ </span><span class="s2">case </span><span class="s4">(</span><span class="s0">name</span><span class="s5">, </span><span class="s0">week</span><span class="s5">, </span><span class="s0">hours</span><span class="s4">) </span><span class="s5">=&gt; </span><span class="s4">(</span><span class="s0">name</span><span class="s5">, </span><span class="s0">hours</span><span class="s5">.</span><span class="s0">sum</span><span class="s4">) }</span><span class="s5">.</span><span class="s0">maxBy</span><span class="s4">(</span><span class="s0">_</span><span class="s5">.</span><span class="s0">_2</span><span class="s4">)</span>
<span class="s4">}</span>

<span class="s1">// Call the maxWork function with the work hours list</span>
<span class="s0">maxWork</span><span class="s4">(</span><span class="s0">stundenProtokoll</span><span class="s4">)</span>

<span class="s2">def </span><span class="s3">daylyMax</span><span class="s4">(</span><span class="s0">l: List</span><span class="s4">[(</span><span class="s0">String</span><span class="s5">, </span><span class="s0">Int</span><span class="s5">, </span><span class="s0">List</span><span class="s4">[</span><span class="s0">Int</span><span class="s4">])])</span><span class="s0">: </span><span class="s4">(</span><span class="s0">Int</span><span class="s5">, </span><span class="s0">List</span><span class="s4">[</span><span class="s0">String</span><span class="s4">]) </span><span class="s5">= </span><span class="s4">{</span>
  <span class="s2">val </span><span class="s0">maxHours </span><span class="s5">= </span><span class="s0">l</span><span class="s5">.</span><span class="s0">flatMap </span><span class="s4">{ </span><span class="s2">case </span><span class="s4">(</span><span class="s0">name</span><span class="s5">, </span><span class="s0">week</span><span class="s5">, </span><span class="s0">hours</span><span class="s4">) </span><span class="s5">=&gt; </span><span class="s0">hours </span><span class="s4">}</span><span class="s5">.</span><span class="s0">max</span>
  <span class="s2">val </span><span class="s0">names </span><span class="s5">= </span><span class="s0">l</span><span class="s5">.</span><span class="s0">collect </span><span class="s4">{</span>
    <span class="s2">case </span><span class="s4">(</span><span class="s0">name</span><span class="s5">, </span><span class="s0">week</span><span class="s5">, </span><span class="s0">hours</span><span class="s4">) </span><span class="s2">if </span><span class="s0">hours</span><span class="s5">.</span><span class="s0">contains</span><span class="s4">(</span><span class="s0">maxHours</span><span class="s4">) </span><span class="s5">=&gt; </span><span class="s0">name</span>
  <span class="s4">}</span><span class="s5">.</span><span class="s0">distinct</span>
  <span class="s4">(</span><span class="s0">maxHours</span><span class="s5">, </span><span class="s0">names</span><span class="s4">)</span>
<span class="s4">}</span>

<span class="s0">daylyMax</span><span class="s4">(</span><span class="s0">stundenProtokoll</span><span class="s4">)</span></pre>
</body>
</html>